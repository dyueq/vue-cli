import{_ as q,d as B,n as E,p as c,x as U,y as S,r as s,o as $,b as I,e as D,f as l,w as o,g as m,F as M,k as Y,h as z,E as L,A as N}from"./index-44866ddc.js";const P=B({setup(){const{proxy:e}=E(),t=c([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"sex",label:"性别"},{prop:"birth",label:"出生日期",width:200},{prop:"addr",label:"地址",width:300}]),C=U([]),d=c({total:0,page:1,name:""}),V=c({name:""}),f=U("add"),n=U(!1),u=c({}),i=c({name:[{required:!0,message:"请输入姓名",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{type:"number",message:"请输入数字"}],sex:[{required:!0,message:"请输入性别",trigger:"change"}],birth:[{required:!0,message:"请输入出生日期",trigger:"change"}],addr:[{required:!0,message:"请输入地址",trigger:"blur"}]}),p=async r=>{let h=await e.$api.getUser(r);C.value=h.list.map(F=>(F.sex=F.sex===0?"女":"男",F)),r.total=h.count},g=()=>{d.name=V.name,p(d)},v=()=>{f.value="add",n.value=!0},k=()=>{e.$refs.form.validate(async r=>{r&&(f.value=="add"?await e.$api.addUser(u)&&(e.$refs.form.resetFields(),p(d),n.value=!1):await e.$api.updateUser(u)&&(e.$refs.form.resetFields(),p(d),n.value=!1))})},b=()=>{e.$refs.form.resetFields(),n.value=!1},_=r=>{n.value=!0,f.value="update",e.$nextTick(()=>{Object.assign(u,r)})},y=async r=>{L.confirm("你确定要删除吗").then(async()=>{await e.$api.deleteUser(r.id),N({showClose:!0,message:"删除成功",type:"success"}),p(d)}).catch(()=>{})},w=r=>{d.page=r,p(d)},a=()=>{b()};return S(()=>{p(d)}),{tableData:C,tableLabel:t,handleClick:_,pageData:d,changePage:w,formInline:V,onSearch:g,dialogVisible:n,handleClose:a,userForm:u,onSubmit:k,rules:i,handleCancle:b,action:f,addUser:v,handleDelete:y}}}),T={class:"userHeader"},j={class:"dialog-footer"},A={class:"table"};function H(e,t,C,d,V,f){const n=s("el-button"),u=s("el-input"),i=s("el-form-item"),p=s("el-form"),g=s("el-option"),v=s("el-select"),k=s("el-date-picker"),b=s("el-dialog"),_=s("el-table-column"),y=s("el-table"),w=s("el-pagination");return $(),I(M,null,[D("div",T,[l(n,{type:"primary",onClick:e.addUser},{default:o(()=>[m("+ 新增")]),_:1},8,["onClick"]),l(p,{inline:!0,model:e.formInline,class:"form-inline"},{default:o(()=>[l(i,null,{default:o(()=>[l(u,{modelValue:e.formInline.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.formInline.name=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(i,null,{default:o(()=>[l(n,{type:"primary",onClick:e.onSearch},{default:o(()=>[m("搜索")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),l(b,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=a=>e.dialogVisible=a),title:e.action=="add"?"新增用户":"修改用户",width:"50%","before-close":e.handleClose},{footer:o(()=>[D("span",j,[l(n,{onClick:e.handleCancle},{default:o(()=>[m("取消")]),_:1},8,["onClick"]),l(n,{type:"primary",onClick:e.onSubmit},{default:o(()=>[m(" 确定 ")]),_:1},8,["onClick"])])]),default:o(()=>[l(p,{inline:!0,model:e.userForm,"label-width":"100px",ref:"form",rules:e.rules},{default:o(()=>[l(i,{label:"姓名",prop:"name"},{default:o(()=>[l(u,{modelValue:e.userForm.name,"onUpdate:modelValue":t[1]||(t[1]=a=>e.userForm.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(i,{label:"年龄",prop:"age"},{default:o(()=>[l(u,{modelValue:e.userForm.age,"onUpdate:modelValue":t[2]||(t[2]=a=>e.userForm.age=a),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1}),l(i,{label:"性别",prop:"sex"},{default:o(()=>[l(v,{modelValue:e.userForm.sex,"onUpdate:modelValue":t[3]||(t[3]=a=>e.userForm.sex=a),placeholder:"请输入性别"},{default:o(()=>[l(g,{label:"男",value:"1"}),l(g,{label:"女",value:"0"})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"出生日期",prop:"birth"},{default:o(()=>[l(k,{modelValue:e.userForm.birth,"onUpdate:modelValue":t[4]||(t[4]=a=>e.userForm.birth=a),type:"date",placeholder:"请输入出生日期",size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(i,{label:"地址",prop:"addr"},{default:o(()=>[l(u,{modelValue:e.userForm.addr,"onUpdate:modelValue":t[5]||(t[5]=a=>e.userForm.addr=a),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","before-close"]),D("div",A,[l(y,{data:e.tableData,style:{width:"100%"},height:"500px"},{default:o(()=>[($(!0),I(M,null,Y(e.tableLabel,a=>($(),z(_,{fixed:"",key:a.prop,prop:a.prop,label:a.label,width:a.width?a.width:125},null,8,["prop","label","width"]))),128)),l(_,{fixed:"right",label:"操作",width:"180"},{default:o(a=>[l(n,{type:"default",size:"small",onClick:r=>e.handleClick(a.row)},{default:o(()=>[m("编辑")]),_:2},1032,["onClick"]),l(n,{type:"danger",size:"small",onClick:r=>e.handleDelete(a.row)},{default:o(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(w,{class:"page",layout:"prev, pager, next",total:e.pageData.total,onCurrentChange:e.changePage},null,8,["total","onCurrentChange"])])],64)}const G=q(P,[["render",H],["__scopeId","data-v-04a0be88"]]);export{G as default};
